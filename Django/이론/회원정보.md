# 회원정보

**UserChangeForm**

- 사용자의 정보 및 권한을 변경하기 위해 admin 인터페이스에서 사용되는 ModelForm
- UserChangeForm 또한 ModelForm이기 때문에 instance 인자로 기존 user 데이터 정보를 받는 구조 또한 동일함
- 이미 전에 CustomUserChangeForm으로 확장했기 때문에 CustomUserChangeForm을 사용



**CustomUserChangeForm fields 재정의	**

- UserChangeForm 은 실제 관리자 화면에서 활용 중인 form으로 세부 필드들이 모두 노출되는 것을 확인할 수 있음
- 직접 fields를 정의하여 원하는 형식으로 활용 가능함
- 



## 비밀번호 변경

**PasswordChangeForm	**

- 사용자가 비번을 변경할 수 있게 함 
- 이전 비번을 입력하여 비번 변경 가능
- 이전 비번을 입력하지 않고 비번을 설정할 수 있는 SetPasswordForm을 상속 받는 서브 클래스



### 암호 변경 시 세션 무효화 방지

- 암호를 바꾸면 기존 세션과의 회원 인증 정보가 일치하지 않게 되어 로그인 상태가 유지되지 못함
- 기존 세션과 회원 인증 정보가 일치하지 않기 때문
- **update_session_auth_hash(request,user)**
  - 현재 요청과 새 session data가 파생 될 업데이트 된 사용자 객체를 가져오고, session data를 적절하게 업데이트 해줌
  - 암호가 변경되어도 로그아웃 되지 않도록 새로운 password의 session data로 session을 업데이트



## 회원 탈퇴

**탈퇴 후 로그아웃의 순서가 바뀌면 안된다.**

- 먼저 로그아웃 해버리면 해당 요청 객체 정보가 없어지기 때문에 탈퇴에 필여한 정보 또한 없어지기 때문이다.

```python
def delete(request):
    request.User.delete() # 삭제
    auth_logout(request)  # 로그아웃
```

